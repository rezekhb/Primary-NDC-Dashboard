SELECT distinct 
GPPC,
COT_Roster,
ndc,
[McK Item Number],
[Item Description],
[McK Invoice Price],
[McK Contract Description],
[MediSpan Mfg],
vw_MediSpanFlatVw.GPI_14_Name,
vw_MediSpanFlatVw.Package_Quantity,
[Medispan Package Desc],
Package_Size,
GPI,
Case
when [Medispan Package Desc] in 
('Vial',
'Syringe',
'Flex Cont',
'Ampule',
'Plas Cont',
'Cup',
'Glass Cont',
'Inhaler',
'Cartridge',
'Crtrdg-NDL',
'Bag',
'Solution',
'Tube',
'Pen')
then [McK Invoice Price] / Package_Quantity
ELSE ([McK Invoice Price]/[Medispan Package Qty])/[Medispan Package Size]
End as Unit_Price,
Case
when vw_MediSpanFlatVw.PkgDesc in 
('Vial',
'Syringe',
'Flex Cont',
'Ampule',
'Plas Cont',
'Cup',
'Glass Cont',
'Inhaler',
'Cartridge',
'Crtrdg-NDL',
'Bag',
'Tube',
'Pen')
then (vw_MediSpanFlatVw.Package_Quantity)
ELSE (vw_MediSpanFlatVw.Package_Quantity *vw_MediSpanFlatVw.Package_Size)
End as TotalPillsQTY


FROM vw_Pharmacy_Cost_File 
join vw_MediSpanFlatVw on vw_Pharmacy_Cost_File.NDC = vw_MediSpanFlatVw.NDC_UPC_HRI

Where 
COT_Roster like 'ACUTE'
and [McK Invoice Price] > '0'
and [McK Contract Description] is not null
and [McK Contract Description] not in 
(
'VNDR PRGM MKTGID0005 B BR',
'VENDOR PROG PBAHGYAA BAXT',
'VNDR PRGM 0006342900 AMGE',
'VNDR PRGM 0017797000 AMGE',
'VNDR PRGM 0017797001 AMGE',
'VNDR PRGM 0050050001 ICU',
'VNDR PRGM 0060000434 CIPL',
'VNDR PRGM 0060000436 CIPL',
'VNDR PRGM 0560100004 ARMA',
'VNDR PRGM 2022007 MEITHEA',
'VNDR PRGM ACC-CHOICE ACCO',
'VNDR PRGM ADVMHC22 ADVAGE',
'VNDR PRGM APD-10001 ATHEN',
'VNDR PRGM AVKACCESS AVKAR',
'VNDR PRGM LP17002 LEUCADI',
'VNDR PRGM PBA284AB BAXTER',
'VNDR PRGM PBA2YEAA BAXTER',
'VNDR PRGM SG10188 I O SAG',
'VNDR PRGM VD2INJ2020 VIRT',
'VNDR PRGM WG10033 WG CRIT',
'VNDR PRGM WWBENEFIT WESTW',
'VNDR PRGM Z00286-1 ZYDUS',
'VNDR PRGM MKTGID0001 B BR',
'VNDR PRGM 900 MYLAN',
'048 CMT PBA2OJAA BAXTER',
'048 CMT 332164-1 TEVA',
'048 CMT ASCEN-002 MYLAN',
'048 CMT PBA1RAAD BAXTER M',
'058 CMT 0008544700 PAR PH',
'048 CMT 0003854701 MALLIN',
'048 CMT A20457-1 SANOFI-A',
'048 CMT 0012981501 MERCK',
'048 CMT 521805-01 GLAXOSM',
'048 CMT 521807-01 GLAXOSM',
'048 CMT 522170-01 GLAXOSM',
'048 CMT PBAWI7AJ BAXTER M',
'048 CMT PBAWI7AM BAXTER M',
'048 CMT 0001898901 NOVART',
'048 CMT 000003350U ASTRA',
'048 CMT 0028911303 ASTRA',
'048 CMT 0028911301 ASTRA',
'048 CMT PBAUSGAA BAXTER',
'048 CMT 200179-02 MAJOR',
'048 CMT 0132995503 NOVO N',
'048 CMT 77548171 JOHNSON',
'048 CMT GSTRG0618 CUMBERL',
'048 CMT GSTRG0618 GLAXOSM',
'048 CMT P70227-1 SANOFI P',
'048 CMT 312420 BRACCO',
'048 CMT 3690-1 GE HEALTHC',
'048 CMT 0023468602 MERCK',
'048 CMT 0023401802 MERCK',
'048 CMT 0030260502 MERCK',
'048 CMT 0030263302 MERCK',
'048 CMT 0030258502 MERCK',
'048 CMT 1011406901 BMS',
'048 CMT 1011398401 BMS',
'048 CMT 000003350K ASTRA',
'048 CMT PBA4TLAC BAXTER M',
'048 CMT A03219-1 BOEHRING',
'048 CMT C17926-20 PFIZER',
'048 CMT C17926-11 PFIZER',
'048 CMT 403106 CONVATEC',
'048 CMT A20026-1 SANOFI-A',
'048 CMT A20145-9 SANOFI',
'048 CMT A20026-5 SANOFI-A',
'048 CMT 0028911302 ASTRA',
'048 CMT 000003350O ASTRA',
'048 CMT 0028911304 ASTRA',
'048 CMT 40639052 BAYER',
'048 CMT A03218-1 BOEHRING',
'048 CMT PBA8OVAA BAXTER M',
'048 CMT 77548101 JOHNSON',
'048 CMT C24350-2 PFIZER',
'99 MPB GDP-MCK GENENTECH,',
'048 CMT 001298151W MERCK',
'048 CMT 521806-03 GLAXOSM',
'048 CMT 522170-02 GLAXOSM',
'048 CMT A03221-1 BOEHRING',
'048 CMT A03220-2 BOEHRING',
'048 CMT 521806-01 GLAXOSM',
'048 CMT 0020503708 AMGEN',
'048 CMT 0020503706 AMGEN',
'048 CMT 0023401807 MERCK',
'048 CMT 0023468607 MERCK',
'048 CMT 0030258504 MERCK',
'048 CMT 0030260505 MERCK',
'048 CMT 0030263305 MERCK',
'048 CMT G-RE-HOSP PURDUE',
'048 CMT UI1 ALCON',
'048 CMT 56251602 J J  JOH',
'048 CMT 85347-00-2 DAVOL',
'048 CMT 85347-00-3 DAVOL',
'048 CMT 0010469600 AMGEN',
'048 CMT 0022291701 AMGEN',
'048 CMT 600011108 BECTON',
'048 CMT PBA7HQAA BAXTER M',
'048 CMT 000003350L ASTRA',
'048 CMT BIOVE01316 BIOVEN',
'048 CMT 77548141 JOHNSON',
'048 CMT TRG-9000 CHIESI',
'048 CMT 0030258501 MERCK',
'048 CMT ORG-1039 ORGANON',
'048 CMT ORG-1094-1 ORGANO',
'048 CMT 001298151Y MERCK',
'048 CMT ORG-1039-1 ORGANO',
'048 CMT PBA03IAA BAXTER',
'048 CMT 0000429227 SANOFI',
'048 CMT 0000434611 SANOFI',
'048 CMT 521804-05 GLAXOSM',
'048 CMT 0050025602 AMGEN',
'048 CMT 0050025604 AMGEN',
'048 CMT 0021332702 AMGEN',
'048 CMT 000003350W ASTRA',
'048 CMT 0023401805 MERCK',
'048 CMT 0030260507 MERCK',
'048 CMT 0023468605 MERCK',
'048 CMT 0030263307 MERCK',
'048 CMT 002891130K ASTRA',
'048 CMT 77548051 JOHNSON',
'048 CMT 4046-3 GE HEALTHC',
'048 CMT 77548221 J J  JOH',
'048 CMT 77548071 JOHNSON',
'048 CMT 0050025504 AMGEN',
'048 CMT 0021332705 AMGEN',
'048 CMT 0022797502 AMGEN',
'048 CMT 521805-03 GLAXOSM',
'048 CMT 0022291900 AMGEN',
'048 CMT 0003495504 ICU ME',
'048 CMT A20165-5 GENZYME',
'048 CMT 000003350Y ASTRA',
'048 CMT 0050022601 AMGEN',
'048 CMT C18090-8 PFIZER',
'048 CMT C19857-11 PFIZER',
'048 CMT 772931411 J J  JO',
'048 CMT 0132995501 NOVO N',
'048 CMT A20026-7 SANOFI-A',
'048 CMT 0023468601 MERCK',
'048 CMT 001298151V MERCK',
'048 CMT 2760400350 AMAG P',
'048 CMT 1296282201 PACIRA',
'048 CMT 77548081 JOHNSON',
'048 CMT 77548031 JOHNSON',
'048 CMT A15593-1 GENZYME',
'048 CMT 000003350V ASTRA',
'048 CMT 000003350X ASTRA',
'048 CMT 77548041 JOHNSON',
'048 CMT C18090-7 PFIZER',
'048 CMT 522046-02 GLAXOSM',
'048 CMT 522046-04 GLAXOSM',
'048 CMT P71071-1 SANOFI P',
'048 CMT 0011562200 AMGEN',
'048 CMT 0050027101 AMGEN',
'048 CMT 0021283007 AMGEN',
'048 CMT 0021283006 AMGEN',
'99 MPB XDP-MCK GENENTECH,',
'99 CMT 06000411 JNJ MPB',
'99 CMT 77548161 JNJ MPB',
'99 CMT 0018361301 AMGEN',
'99 MPB 0050009801 AMGEN',
'99 MPB 06000471 J J  JOHN',
'99 MPB 0022605501 AMGEN',
'99 MPB 0050024001 AMGEN',
'99 CMT 01280434 MPB VARIO',
'99 MPB ZRTAD001 FLEXION T',
'99 MPB GKOMCSPLT0 KEDRION',
'99 MPB HPG-B027 CHIESI MP',
'99 MPB PH5237-5 TAKEDA PH',
'VNDR PRGM 0050001203 AMGE',
'VNDR PRGM 0050001203 AMGE',
'VNDR PRGM 0050001204 AMGE',
'VNDR PRGM 0050001204 AMGE',
'VNDR PRGM 0050001204 AMGE',
'VNDR PRGM PBA5T0AB BAXTER',
'VNDR PRGM 0050001205 AMGE',
'VNDR PRGM 1061000045 PROV',
'VNDR PRGM 1060500038 PROV'

)



Group by 
GPPC,
COT_Roster,
ndc,
[McK Item Number],
[Item Description],
[McK Invoice Price],
[McK Contract Description],
[Medispan Package Qty],
[Medispan Package Size],
[MediSpan Mfg],
vw_MediSpanFlatVw.PkgDesc,
[Medispan Package Desc],
vw_MediSpanFlatVw.GPI_14_Name,
vw_MediSpanFlatVw.Package_Quantity,
Package_Size,
[GPI 14],
GPI

Order by Gppc, [McK Invoice Price] asc